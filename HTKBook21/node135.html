<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 3.0//EN">
<!--Converted with LaTeX2HTML 96.1 (Feb 5, 1996) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds -->
<HTML>
<HEAD>
<TITLE>11.7 Constructing a Dictionary</TITLE>
<META NAME="description" CONTENT="11.7 Constructing a Dictionary">
<META NAME="keywords" CONTENT="HTKBook">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<LINK REL=STYLESHEET HREF="HTKBook.css">
</HEAD>
<BODY LANG="EN">
 <A NAME="tex2html3311" HREF="node136.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="next_motif.gif"></A> <A NAME="tex2html3309" HREF="node128.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="up_motif.gif"></A> <A NAME="tex2html3303" HREF="node134.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="previous_motif.gif"></A> <A NAME="tex2html3313" HREF="node1.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="contents_motif.gif"></A> <A NAME="tex2html3314" HREF="node263.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="index_motif.gif"></A> <BR>
<B> Next:</B> <A NAME="tex2html3312" HREF="node136.html">11.8 Word Network Expansion</A>
<B>Up:</B> <A NAME="tex2html3310" HREF="node128.html">11 NetworksDictionaries and Language Models</A>
<B> Previous:</B> <A NAME="tex2html3304" HREF="node134.html">11.6 Testing a Word Network using HSGEN</A>
<BR> <P>
<H1><A NAME="SECTION03870000000000000000">11.7 Constructing a Dictionary</A></H1>
<A NAME="susehdman">&#160;</A>
<P>
As explained in section&nbsp;<A HREF="node129.html#snetuse">11.1</A>, the word level network is expanded by
HNET to create the network of HMM instances needed by the recogniser.
The way in which each word is expanded is determined from a
dictionary<A NAME=10579>&#160;</A>.
<P>
A dictionary for use in HTK has a very simple format.<A NAME=10580>&#160;</A>
Each line consists of a single word pronunciation with format
<PRE>    WORD [OUTSYM] PRONPROB P1 P2 P3 P4 ....</PRE>
where <tt>WORD</tt> represents the word, <tt>OUTSYM</tt> is the symbol to
output when that word is recognised, <tt>PRONPROB</tt> is the pronunciation
probability (0.0 - 1.0) and <tt>P1</tt>, <tt>P2</tt>, ...are the
sequence of phones or HMMs to be used in recognising that word. The output
symbol and the pronunciation probability are optional. If an output symbol is
not specified, the name of the word itself is output. Empty square brackets,
<tt>[]</tt>, can be used to suppress any output when that word is recognised.
For example, a dictionary for the But-Bit grammar might contain
<PRE>    bit           b  i  t 
    but           b  u  t
    start  []     sil
    end    []     sil</PRE>
where for simplicity the phones are being represented by the letters of the alphabet.
<P>
If any word has more than one pronunciation, then the word
has a repeated entry, for example,
<PRE>    the           th iy
    the           th ax</PRE>
corresponding to the stressed and unstressed forms of the word
``the''.<A NAME=10587>&#160;</A>
<P>
The pronunciations in a dictionary are normally at the phone
level as in the above examples.  However, if context-dependent
models are wanted, these can be included directly in the dictionary.
For example, the Bit-But entries might be written as
<PRE>    bit           b+i  b-i+t  i-t 
    but           b+u  b-u+t  u-t</PRE>
In principle, this is never necessary since HNET can perform context
expansion automatically, however, it saves computation to do this
off-line as part of the dictionary construction process.  Of course,
this is only possible for word-internal context dependencies.
Cross-word dependencies can only be generated by HNET.
<P>
<A NAME="fdmaker">&#160;</A> <IMG WIDTH=454 HEIGHT=408 ALIGN=BOTTOM ALT="tex2html_wrap22064" SRC="img460.gif"  > 
<P>
Pronouncing dictionaries are a valuable resource and if produced
manually, they can require considerable investment.  There are
a number of commercial and public domain dictionaries available,
however, these will typically have differing formats and will
use different phone sets.  To assist in the process of
dictionary construction, HTK provides a tool called HDMAN
which can be used to edit and merge differing source dictionaries
to form a single uniform dictionary.  The way that
HDMAN<A NAME=10752>&#160;</A> works is illustrated in Fig.&nbsp;<A HREF="node135.html#fdmaker">11.7</A>.
<P>
Each source dictionary file must have one pronunciation per line and the
words must be sorted into alphabetical order.  The word entries must be
valid HTK strings as defined in section&nbsp;<A HREF="node45.html#shtkstrings">4.6</A>.  If an
arbitrary character sequence is to be allowed, then the input edit
script should have the command <tt>IM RAW</tt> as its first command.
<P>
The basic operation of 
HDMAN is to scan the input streams and for each new word
encountered, copy the entry to the output.  In the figure,  a word list
is also shown.  This is optional but if included 
HDMAN only copies words in the list.  Normally, HDMAN
copies just the first pronunciation that it finds for any word. Thus,
the source dictionaries are usually arranged in order of
<i>reliability</i>, possibly preceded by a small dictionary of special
word pronunciations. For example, in Fig.&nbsp;<A HREF="node135.html#fdmaker">11.7</A>, the main
dictionary might be <tt>Src2</tt>.  <tt>Src1</tt> might be a small 
dictionary containing correct pronunciations for words in <tt>Src2</tt>
known to have  errors in them. Finally, <tt>Src3</tt> might be a large
poor quality dictionary (for example, it could be generated
by a rule-based text-to-phone system) which is included as a last resort
source of pronunciations for words not in the main dictionary.
<P>
As shown in the figure, HDMAN can apply a set of editing
commands to each source dictionary and it can also edit the
output stream.  The commands available are described in full in
the reference section.  They operate in a similar way to
those in HLED.  Each set of commands is written in
an edit script with one command per line.  Each input edit script
has the same name as the corresponding source dictionary but with
the extension <tt>.ded</tt> added.  The output edit script is stored
in a file called <tt>global.ded</tt><A NAME=10753>&#160;</A>.  
The commands provided
include replace and delete at the word and phone level, context-sensitive
replace and automatic conversions to left biphones, right biphones
and word internal triphones.<A NAME=10613>&#160;</A>
<P>
When HDMAN loads a dictionary it adds word boundary symbols to
the start and end of each pronunciation and then deletes them when
writing out the new dictionary.  The default for these word boundary
symbols is <tt>#</tt> but it can be redefined using the <tt>-b</tt>
option.  The reason for this is to allow context-dependent edit commands 
to take account of word-initial and word-final phone positions.  
The examples below will illustrate this.
<P>
Rather than go through each HDMAN edit command in detail, some examples
will illustrate the typical manipulations that can be performed
by HDMAN.  Firstly, suppose that a dictionary transcribed
unstressed ``-ed'' endings as <tt>ih0 d</tt>
but the required dictionary
does not mark stress but uses a schwa in such cases, that is,
the transformations<A NAME=10754>&#160;</A><A NAME=10755>&#160;</A>
<PRE>    ih0 d  #   -&gt;   ax d
    ih0        -&gt;   ih  (otherwise)</PRE>
are required.
These could be achieved by the following 3 commands
<PRE>    MP axd0 ih0 d #
    SP axd0 ax d #
    RP ih ih0</PRE>
The context sensitive replace is achieved by merging all sequences
of <tt>ih0 d #</tt> and then splitting the result into the sequence
<tt>ax d #</tt>.  The final <tt>RP</tt> command<A NAME=10756>&#160;</A> then unconditionally
replaces all occurrences of <tt>ih0</tt> by <tt>ih</tt>.
As a second similar example, suppose that all examples of <tt>ax l</tt>
(as in ``bottle'') are to be replaced by the single phone <tt>el</tt>
provided that the immediately following phone is a non-vowel.
This requires the use of the <tt>DC</tt> command<A NAME=10757>&#160;</A> to define a
context consisting of all non-vowels, then a merge using  <tt>MP</tt>
as above followed by a context-sensitive replace
<PRE>    DC nonv l r w y .... m n ng #
    MP axl ax l
    CR el * axl nonv
    SP axl ax l</PRE>
the final step converts all non-transformed cases of <tt>ax l</tt>
back to their original form.
<P>
As a final example, a typical output transformation applied via
the edit script <tt>global.ded</tt> will convert all phones to
context-dependent form and append a short pause model <tt>sp</tt>
at the end of each pronunciation.  The following two commands will
do this
<PRE>    TC
    AS sp</PRE>
For example, these commands would convert the dictionary entry
<PRE>    BAT b ah t</PRE>
into
<PRE>    BAT b+ah b-ah+t ah-t sp</PRE>
<P>
Finally, if the <tt>-l</tt> option is set, 
HDMAN will generate a log file containing
a summary of the pronunciations used from each source and
how many words, if any are missing.  It is also possible to
give HDMAN a phone list using the <tt>-n</tt> option.
In this case, HDMAN will record how many times each phone
was used and also, any phones that appeared in pronunciations but
are not in the phone list.  This is useful for detecting errors and 
unexpected phone symbols in the source dictionary.
<P>
<HR><A NAME="tex2html3311" HREF="node136.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="next_motif.gif"></A> <A NAME="tex2html3309" HREF="node128.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="up_motif.gif"></A> <A NAME="tex2html3303" HREF="node134.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="previous_motif.gif"></A> <A NAME="tex2html3313" HREF="node1.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="contents_motif.gif"></A> <A NAME="tex2html3314" HREF="node263.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="index_motif.gif"></A> <BR>
<B> Next:</B> <A NAME="tex2html3312" HREF="node136.html">11.8 Word Network Expansion</A>
<B>Up:</B> <A NAME="tex2html3310" HREF="node128.html">11 NetworksDictionaries and Language Models</A>
<B> Previous:</B> <A NAME="tex2html3304" HREF="node134.html">11.6 Testing a Word Network using HSGEN</A>
<P><ADDRESS>
ECRL HTK_V2.1: email support@entropic.com
</ADDRESS>
</BODY>
</HTML>
