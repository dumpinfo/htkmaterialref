<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 3.0//EN">
<!--Converted with LaTeX2HTML 96.1 (Feb 5, 1996) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds -->
<HTML>
<HEAD>
<TITLE>7.4 HMM Sets</TITLE>
<META NAME="description" CONTENT="7.4 HMM Sets">
<META NAME="keywords" CONTENT="HTKBook">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<LINK REL=STYLESHEET HREF="HTKBook.css">
</HEAD>
<BODY LANG="EN">
 <A NAME="tex2html2830" HREF="node98.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="next_motif.gif"></A> <A NAME="tex2html2828" HREF="node93.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="up_motif.gif"></A> <A NAME="tex2html2822" HREF="node96.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="previous_motif.gif"></A> <A NAME="tex2html2832" HREF="node1.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="contents_motif.gif"></A> <A NAME="tex2html2833" HREF="node263.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="index_motif.gif"></A> <BR>
<B> Next:</B> <A NAME="tex2html2831" HREF="node98.html">7.5 Tied-Mixture Systems</A>
<B>Up:</B> <A NAME="tex2html2829" HREF="node93.html">7 HMM Definition Files</A>
<B> Previous:</B> <A NAME="tex2html2823" HREF="node96.html">7.3 Macro Definitions</A>
<BR> <P>
<H1><A NAME="SECTION03440000000000000000">7.4 HMM Sets</A></H1>
<A NAME="shmmsets">&#160;</A>
<P>
The previous sections have described how a single HMM definition
can be specified.  However, many HTK tools require complete model
sets to be specified rather than just a single model.<A NAME=6127>&#160;</A>
When this is the case, the individual HMMs which belong to the set
are listed in a file rather than being enumerated explicitly on
the command line.  Thus, for example, a typical invocation of
the tool HEREST might be as follows
<PRE>    HERest ... -H mf1 -H mf2 ... hlist</PRE>
where each <tt>-H</tt> option names a macro file and <tt>hlist</tt>
contains a list of HMM names, one per line. For example, it might contain
<PRE>    ha
    hb
    hc</PRE>
In a case such as this, the macro files would normally<A NAME=6131>&#160;</A>
contain definitions for the models <tt>ha</tt>, 
<tt>hb</tt> and <tt>hc</tt>, along with any lower level macro 
definitions that they might require.
<P>

<P>
 <IMG WIDTH=331 HEIGHT=412 ALIGN=BOTTOM ALT="tex2html_wrap20920" SRC="img284.gif"  > 
<P>
<A NAME="fmac6def">&#160;</A>
<DIV ALIGN=CENTER><P ALIGN=CENTER> <IMG WIDTH=329 HEIGHT=28 ALIGN=BOTTOM ALT="tex2html_wrap20922" SRC="img285.gif"  > </P></DIV>
<P>
As an illustration,
Fig&nbsp;<A HREF="node97.html#fmac6def">7.9</A> and Fig&nbsp;<A HREF="node97.html#fhmm6def">7.10</A> give examples of
what the macro files <tt>mf1</tt> and <tt>mf2</tt> might contain.
The first file contains definitions for three states and a
transition matrix.  The second file
contains definitions for the three HMMs.  In this example,
each HMM shares the three
states and the common transition matrix.  A HMM set such as 
this is called a <i>tied-state</i> system.
<P>
The order in which macro files are listed on
the command line and the order of definition within
each file must ensure that all macro
definitions are defined before they are referenced.
Thus, macro files are typically organised such that all
low level structures come first followed by states and
transition matrices, with the actual HMM definitions coming last.
<P>
When the HMM list contains the name of a HMM for which no corresponding
macro has been defined, then an attempt is made to open a file with the
same name.  This file is expected to contain a single definition 
corresponding to the required HMM.  Thus, the general mechanism for
loading a set of HMMs is as shown in Fig&nbsp;<A HREF="node97.html#fhsetdef">7.11</A>.  In this
example, the HMM list <tt>hlist</tt> contains the names of five HMMs 
of which
only three have been predefined via the macro files.  Hence, the
remaining definitions are found in individual HMM definition files
<tt>hd</tt> and <tt>he</tt>.
<P>

<P>
When a large number of HMMs must be loaded from individual files, it is
common to store them in a specific directory.  Most HTK tools allow
this directory to be specified explicitly using a command line option.
For example, in the command
<PRE>    HERest -d hdir ... hlist ....</PRE>
the definitions for the HMM listed in <tt>hlist</tt> will be
searched for in the subdirectory <tt>hdir</tt>.
<P>

<P>
 <IMG WIDTH=331 HEIGHT=621 ALIGN=BOTTOM ALT="tex2html_wrap20924" SRC="img286.gif"  > 
<P>
<A NAME="fhmm6def">&#160;</A>
<DIV ALIGN=CENTER><P ALIGN=CENTER> <IMG WIDTH=271 HEIGHT=15 ALIGN=BOTTOM ALT="tex2html_wrap20926" SRC="img287.gif"  > </P></DIV>
<P>
<A NAME=7590>&#160;</A>
After loading each HMM set, HMODEL marks it as belonging
to one of the following categories (called the <i>HSKind</i><A NAME=7626>&#160;</A>)
<UL><LI> <tt>PLAINHS</tt><LI> <tt>SHAREDHS</tt><LI> <tt>TIEDHS</tt><LI> <tt>DISCRETEHS</tt>
</UL>
Any HMM set containing discrete output distributions is assigned<A NAME=7600>&#160;</A>
to the <tt>DISCRETEHS</tt><A NAME=7627>&#160;</A> category (see section&nbsp;<A HREF="node99.html#sdischmm">7.6</A>).  
If all mixture components are tied, then it
is assigned to the <tt>TIEDHS</tt> category (see section&nbsp;<A HREF="node98.html#stmix">7.5</A>).  
If it contains any shared states ( <IMG WIDTH=8 HEIGHT=3 ALIGN=BOTTOM ALT="tex2html_wrap_inline20906" SRC="img433.gif"  > <i>s</i> macros) 
or Gaussians ( <IMG WIDTH=8 HEIGHT=3 ALIGN=BOTTOM ALT="tex2html_wrap_inline20908" SRC="img433.gif"  > <i>m</i> macros) then it is <tt>SHAREDHS</tt><A NAME=7628>&#160;</A>.
Otherwise, it is <tt>PLAINHS</tt>. The  category assigned
to a HMM set determines which of several possible optimisations
the various HTK tools can apply to it.  As a check, the required kind of
a HMM set can also be set via the configuration variable <tt>HMMSETKIND</tt>.
For debugging purposes, this can also be used to re-categorise a 
<tt>SHAREDHS</tt> system as <tt>PLAINHS</tt><A NAME=7629>&#160;</A>.
<P>
As shown in Figure&nbsp;<A HREF="node96.html#fhierarch">7.8</A>, complete HMM
definitions can be tied as well as their individual parameters.  However,
tying at the HMM level is defined in a different way.  
HMM lists have so far<A NAME=7616>&#160;</A>
been described as simply a list of model names. In fact, every HMM has two
names: a <I>logical</I> name and a <I>physical name</I>. The logical name
reflects the r&#244;le of the model and the physical name is used to
identify the definition on disk.  By default, the logical and physical names
are identical.  HMM tying is implemented by letting several logically
distinct HMMs share the same physical definition.  This is done by giving
an explicit physical name immediately after the logical name in a HMM 
list<A NAME=7620>&#160;</A>.
<P>

<P>
<A NAME="fhsetdef">&#160;</A> <IMG WIDTH=486 HEIGHT=382 ALIGN=BOTTOM ALT="tex2html_wrap20928" SRC="img290.gif"  > 
<P>
For example, in the HMM list shown in Fig&nbsp;<A HREF="node97.html#fhlisteg">7.12</A>,
the logical HMMs <TT>two</TT>, <TT>too</TT> and <TT>to</TT> are tied
and share the same physical HMM definition <TT>tuw</TT>.  The HMMs <TT>one</TT>
and <TT>won</TT> are also tied but in this case <TT>won</TT> shares <TT>one</TT>'s
definition.  There is, however, no subtle distinction here. The two different
cases are given just to emphasise that the names used for the logical and physical
HMMs can be the same or different, as is convenient.  Finally, in this example,
the models <TT>three</TT> and <TT>four</TT> are untied.
<P>

<P>
 <IMG WIDTH=290 HEIGHT=133 ALIGN=BOTTOM ALT="tex2html_wrap20930" SRC="img291.gif"  > 
<P>
<A NAME="fhlisteg">&#160;</A>
<DIV ALIGN=CENTER><P ALIGN=CENTER> <IMG WIDTH=244 HEIGHT=15 ALIGN=BOTTOM ALT="tex2html_wrap20932" SRC="img292.gif"  > </P></DIV>
<P>
This mechanism is implemented internally by creating a  <IMG WIDTH=8 HEIGHT=3 ALIGN=BOTTOM ALT="tex2html_wrap_inline20910" SRC="img433.gif"  > <i>l</i> macro
definition for every HMM in the HMM list.  If an explicit physical HMM
is also given in the list, then the logical HMM is linked to 
that macro, otherwise a  <IMG WIDTH=8 HEIGHT=3 ALIGN=BOTTOM ALT="tex2html_wrap_inline20912" SRC="img433.gif"  > <i>h</i> macro
is created with the same name as the  <IMG WIDTH=8 HEIGHT=3 ALIGN=BOTTOM ALT="tex2html_wrap_inline20914" SRC="img433.gif"  > <i>l</i> macro.  Notice that this is
one case where the ``define before use'' rule is relaxed.  If an undefined
 <IMG WIDTH=8 HEIGHT=3 ALIGN=BOTTOM ALT="tex2html_wrap_inline20916" SRC="img433.gif"  > <i>h</i> is encountered then a dummy place-holder is created for it and,
as explained above,
HMODEL subsequently tries to find a HMM definition 
file of the same name.
<P>

<P>
Finally it should be noted that 
in earlier versions of HTK, there were no HMM macros.  However,
HMM definitions could be listed in a single <A NAME=6272>&#160;</A>
<i>master macro file</i> or MMF<A NAME=6274>&#160;</A>.  Each HMM definition began
with its name written as a quoted string and ended with a period
written on its own (just like master label files), and  the first
line of an MMF contained the string <tt>#!MMF!#</tt>.  In HTK  V2.0    ,\
the use of MMFs has been subsumed within the general macro
definition facility using the  <IMG WIDTH=8 HEIGHT=3 ALIGN=BOTTOM ALT="tex2html_wrap_inline20918" SRC="img433.gif"  > <i>h</i> type.
However, for compatibility, the older MMF style of file can still be
read by all HTK tools.
<P>
<HR><A NAME="tex2html2830" HREF="node98.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="next_motif.gif"></A> <A NAME="tex2html2828" HREF="node93.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="up_motif.gif"></A> <A NAME="tex2html2822" HREF="node96.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="previous_motif.gif"></A> <A NAME="tex2html2832" HREF="node1.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="contents_motif.gif"></A> <A NAME="tex2html2833" HREF="node263.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="index_motif.gif"></A> <BR>
<B> Next:</B> <A NAME="tex2html2831" HREF="node98.html">7.5 Tied-Mixture Systems</A>
<B>Up:</B> <A NAME="tex2html2829" HREF="node93.html">7 HMM Definition Files</A>
<B> Previous:</B> <A NAME="tex2html2823" HREF="node96.html">7.3 Macro Definitions</A>
<P><ADDRESS>
ECRL HTK_V2.1: email support@entropic.com
</ADDRESS>
</BODY>
</HTML>
